Search.setIndex({"docnames": ["index", "komet", "modules", "vignettes/komet", "vignettes/komet_uniprotLAkernel"], "filenames": ["index.rst", "komet.rst", "modules.rst", "vignettes/komet.ipynb", "vignettes/komet_uniprotLAkernel.ipynb"], "titles": ["Komet - Kronecker Optimized Method for DTI Prediction", "komet module", "komet", "komet : Kronecker Optimized METhod for DTI prediction", "Komet with Uniprot LAkernel"], "terms": {"thi": [0, 1], "librari": 0, "i": [0, 1, 3, 4], "design": 0, "biologi": 0, "cheminformat": 0, "focus": 0, "analysi": 0, "interact": [0, 1], "It": [0, 1], "provid": 0, "tool": 0, "process": [0, 1], "protein": [0, 1], "fingerprint": [0, 1, 4], "estim": [0, 1], "probabl": [0, 1, 3, 4], "perform": [0, 1], "suit": 0, "particularli": 0, "us": [0, 1], "research": 0, "develop": 0, "work": 0, "drug": 0, "discoveri": 0, "dock": 0, "simul": 0, "If": [0, 1], "you": [0, 4], "pleas": 0, "sure": 0, "cite": 0, "articl": 0, "komet2024": 0, "titl": [0, 3, 4], "advanc": 0, "target": [0, 1, 3, 4], "leverag": 0, "larg": 0, "scale": [0, 1, 3, 4], "dataset": [0, 1, 3], "rapid": 0, "robust": 0, "chemogenom": 0, "algorithm": [0, 1], "author": 0, "view": 0, "orcid": 0, "profilegwenn": 0, "guichaoua": [0, 3, 4], "philipp": 0, "pinel": 0, "brice": 0, "hoffmann": 0, "chlo\u00e9": 0, "agath": 0, "azencott": 0, "v\u00e9roniqu": 0, "stoven": 0, "journal": 0, "biorxiv": 0, "year": 0, "2024": 0, "doi": 0, "10": [0, 3, 4], "1101": 0, "02": 0, "22": [0, 4], "581599": 0, "url": 0, "http": [0, 3, 4], "www": 0, "org": 0, "content": 0, "581599v1": 0, "abstract": 0, "crucial": 0, "heavili": 0, "reli": 0, "supervis": 0, "learn": 0, "techniqu": 0, "In": [0, 3, 4], "context": 0, "known": 0, "associ": 0, "between": 0, "molecul": [0, 1], "allow": 0, "new": 0, "base": 0, "pattern": 0, "paper": 0, "we": [0, 3, 4], "present": [0, 4], "novel": 0, "approach": 0, "address": 0, "two": 0, "kei": 0, "challeng": 0, "avail": 0, "high": 0, "qualiti": 0, "scalabl": 0, "first": [0, 1], "introduc": 0, "lcidb": [0, 3, 4], "curat": 0, "size": [0, 1, 3, 4], "offer": 0, "extens": [0, 1], "coverag": 0, "both": 0, "druggabl": 0, "space": 0, "notabl": 0, "lcidbcontain": 0, "much": 0, "higher": 0, "number": [0, 1, 3, 4], "expand": 0, "compar": 0, "tradit": 0, "benchmark": 0, "second": [0, 3, 4], "propos": 0, "pipelin": 0, "without": 0, "compromis": 0, "three": 0, "step": [0, 3, 4], "framework": 0, "incorpor": 0, "effici": 0, "choic": [0, 3], "tailor": 0, "involv": 0, "nystr\u00f6m": 0, "approxim": [0, 1], "specif": 0, "emploi": 0, "modul": [0, 2], "pair": [0, 1], "which": [0, 1, 4], "suffici": 0, "express": 0, "whose": 0, "structur": 0, "reduc": 0, "complex": 0, "our": 0, "implement": 0, "open": [0, 3, 4], "sourc": [0, 1], "softwar": 0, "lever": 0, "ag": 0, "gpu": [0, 3, 4], "parallel": 0, "demonstr": 0, "variou": [0, 1], "show": [0, 3, 4], "displai": 0, "superior": 0, "state": 0, "art": 0, "deep": 0, "addition": 0, "illustr": 0, "gener": 0, "properti": 0, "its": 0, "abil": 0, "solv": 0, "scaffold": 0, "hop": 0, "problem": 0, "gather": 0, "publicli": 0, "lh": 0, "readthedoc": 0, "io": 0, "The": [0, 1], "requir": [0, 3, 4], "follow": 0, "python": 0, "packag": [0, 3, 4], "panda": [0, 3, 4], "numpi": [0, 1, 3, 4], "rdkit": [0, 1, 3, 4], "torch": [0, 1, 3, 4], "scikit": 0, "zipp": 0, "pickl": [0, 3, 4], "To": [0, 4], "run": 0, "pip": [0, 3, 4], "pypi": 0, "load_df": [0, 1, 2, 3, 4], "name": [0, 1], "datafram": [0, 1, 3, 4], "from": [0, 1], "csv": [0, 1, 3, 4], "file": [0, 1, 4], "clean": [0, 1, 3, 4], "up": [0, 1], "smile": [0, 1, 3, 4], "string": [0, 1], "cannot": [0, 1], "read": [0, 1], "add_indsmil": [0, 1, 2], "df": [0, 1], "add": [0, 1, 3, 4], "each": [0, 1, 3], "uniqu": [0, 1], "add_indfasta": [0, 1, 2], "an": [0, 1], "index": [0, 1], "column": [0, 1], "fasta": [0, 1, 3, 4], "sequenc": [0, 1, 3, 4], "morgan_fp": [0, 1, 2, 3, 4], "list_smil": [0, 1, 3, 4], "morgan": [0, 1, 3, 4], "list": [0, 1], "nystrom_x": [0, 1, 2], "smiles_list": [0, 1], "": [0, 1, 3, 4], "morganfp": [0, 1, 3, 4], "v": [0, 1], "rm": [0, 1], "mu": [0, 1], "epsi": [0, 1], "kernel": [0, 1], "nystrom": [0, 1], "svm_bfg": [0, 1, 2, 3, 4], "x_cn": [0, 1, 3, 4], "y_cn": [0, 1, 3, 4], "y": [0, 1, 3, 4], "j": [0, 1, 3, 4], "lamb": [0, 1, 3, 4], "svm": [0, 1], "l": [0, 1, 3, 4], "bfg": [0, 1, 3, 4], "compute_proba_platt_scal": [0, 1, 2, 3, 4], "w_bfg": [0, 1, 3, 4], "platt": [0, 1, 3, 4], "compute_proba": [0, 1, 2, 3, 4], "b_bfg": [0, 1, 3, 4], "t": [0, 1, 3, 4], "weight": [0, 1, 3, 4], "paramet": [0, 1, 3, 4], "result": [0, 1, 2, 3, 4], "y_pred": [0, 1, 3, 4], "proba_pr": [0, 1, 3, 4], "return": [0, 1], "metric": [0, 1, 3, 4], "import": [0, 3, 4], "pd": [0, 1, 3, 4], "your": 0, "molecule_data": 0, "welcom": 0, "have": 0, "suggest": 0, "improv": 0, "bug": 0, "fix": 0, "issu": 0, "pull": 0, "request": 0, "mit": 0, "search": 0, "page": 0, "comput": [1, 3, 4], "A": 1, "tensor": [1, 3, 4], "contain": [1, 3, 4], "input": [1, 4], "type": [1, 3], "featur": 1, "molecular": 1, "indic": 1, "subset": 1, "sampl": 1, "precomput": [1, 3, 4], "eigenvector": 1, "matrix": [1, 3, 4], "rank": 1, "eigenvalu": 1, "small": [1, 4], "regular": 1, "term": 1, "ad": 1, "numer": 1, "stabil": 1, "nystrom_x_cn": [1, 2, 3, 4], "mm": [1, 3, 4], "nm": [1, 3, 4], "center": 1, "normal": [1, 3, 4], "int": [1, 3, 4], "landmark": 1, "dimens": [1, 3, 4], "keep": 1, "after": 1, "svd": [1, 3], "total": 1, "ndarrai": [1, 3], "shape": [1, 3, 4], "fingerprint_length": 1, "note": 1, "function": [1, 4], "given": 1, "select": 1, "random": 1, "k": 1, "singular": 1, "valu": [1, 3, 4], "decomposit": 1, "final": [1, 3, 4], "ar": [1, 3, 4], "divid": 1, "l2": 1, "norm": [1, 3, 4], "should": 1, "arrai": 1, "niter": [1, 3, 4], "50": [1, 3, 4], "train": 1, "model": [1, 3, 4], "optim": [1, 4], "minim": 1, "loss": 1, "compound": 1, "label": [1, 3, 4], "iter": 1, "bia": 1, "histori": 1, "tupl": 1, "float": 1, "updat": 1, "indfasta": [1, 3, 4], "np": [1, 3, 4], "offset": 1, "margin": 1, "predict": [1, 4], "20": [1, 3, 4], "load_data": [1, 2, 3, 4], "load": [1, 4], "data": [1, 4], "includ": 1, "along": 1, "dataset_dir": [1, 3, 4], "str": 1, "zip": [1, 3, 4], "archiv": 1, "extract": 1, "option": 1, "directori": 1, "where": [1, 3, 4], "locat": 1, "default": 1, "can": [1, 4], "accuraci": [1, 3, 4], "auc": [1, 3, 4], "averag": 1, "precis": 1, "threshold": [1, 3, 4], "classif": 1, "best": [1, 3], "confus": [1, 3, 4], "fals": [1, 3, 4], "posit": [1, 3, 4], "rate": 1, "true": [1, 4], "befor": 1, "appli": [1, 3, 4], "atil": 3, "lakernel": 3, "chosen": 3, "load_ext": [3, 4], "autoreload": [3, 4], "matplotlib": [3, 4], "pyplot": [3, 4], "plt": [3, 4], "zipfil": [3, 4], "time": [3, 4], "sklearn": [3, 4], "average_precision_scor": [3, 4], "roc_curv": [3, 4], "confusion_matrix": [3, 4], "precision_scor": [3, 4], "recall_scor": [3, 4], "devic": [3, 4], "cuda": [3, 4], "0": [3, 4], "is_avail": [3, 4], "els": [3, 4], "cpu": [3, 4], "device_cpu": [3, 4], "print": [3, 4], "mytyp": [3, 4], "float16": [3, 4], "save": [3, 4], "memori": [3, 4], "onli": [3, 4], "float32": [3, 4], "instal": [3, 4], "collect": [3, 4], "2023": [3, 4], "9": [3, 4], "5": [3, 4], "cp310": [3, 4], "manylinux_2_17_x86_64": [3, 4], "manylinux2014_x86_64": [3, 4], "whl": [3, 4], "34": [3, 4], "4": 3, "mb": [3, 4], "25": [3, 4], "eta": [3, 4], "00": [3, 4], "alreadi": [3, 4], "satisfi": [3, 4], "usr": [3, 4], "local": 3, "lib": [3, 4], "python3": [3, 4], "dist": [3, 4], "pillow": [3, 4], "successfulli": [3, 4], "wget": [3, 4], "q": [3, 4], "com": [3, 4], "raw": [3, 4], "main": [3, 4], "py": [3, 4], "mkdir": [3, 4], "orphan": [3, 4], "mv": [3, 4], "dict_ind2fasta_lcidb": 3, "dict_ind2fasta_lcidb_k_prot": 3, "6": [3, 4], "full": [3, 4], "ha": [3, 4], "all": [3, 4], "concat": [3, 4], "236530": [3, 4], "21844": [3, 4], "45005": [3, 4], "303379": [3, 4], "7": [3, 4], "drop_dupl": [3, 4], "flatten": [3, 4], "len": [3, 4], "differ": [3, 4], "mol": [3, 4], "dict_smiles2ind": [3, 4], "rang": [3, 4], "indsmil": [3, 4], "x": [3, 4], "143255": [3, 4], "8": [3, 4], "kernel_first": [3, 4], "fp": [3, 4], "reduct": [3, 4], "3000": [3, 4], "medium": [3, 4], "databas": [3, 4], "dm": [3, 4], "1000": [3, 4], "dim": [3, 4], "case": [3, 4], "less": [3, 4], "than": [3, 4], "min": [3, 4], "11": [3, 4], "same": [3, 4], "order": [3, 4], "ind_fasta": [3, 4], "dan": [3, 4], "et": [3, 4], "2069": [3, 4], "12": [3, 4], "dictionari": 3, "rb": [3, 4], "dict_fasta2ind_lcidb": 3, "ind": [3, 4], "item": [3, 4], "f": [3, 4], "kp_lcidb": 3, "13": [3, 4], "i_fasta": [3, 4], "dict": [3, 4], "kp": 3, "dtype": [3, 4], "prot": 3, "14": [3, 4], "just": [3, 4], "rp": 3, "500": 3, "u": [3, 4], "vt": 3, "diag": [3, 4], "sqrt": [3, 4], "nomramlis": 3, "y_c": [3, 4], "mean": [3, 4], "axi": [3, 4], "none": [3, 4], "15": [3, 4], "n": [3, 4], "16": [3, 4], "i_test": [3, 4], "j_test": [3, 4], "y_test": [3, 4], "n_test": [3, 4], "17": [3, 4], "1e": [3, 4], "history_lbfgs_svm": [3, 4], "history_lbfgs_platt": [3, 4], "6010": 3, "18": [3, 4], "m_train": 3, "y_pred_train": 3, "proba_pred_train": 3, "acc1_train": 3, "au_roc_train": 3, "au_pr_train": 3, "thred_optim_train": 3, "acc_best_train": 3, "cm_train": 3, "fp_train": 3, "roc": [3, 4], "4f": [3, 4], "aupr": 3, "9995": 3, "9993": 3, "9978": 3, "4442": 3, "0030": 3, "19": [3, 4], "m": [3, 4], "acc1": [3, 4], "au_roc": [3, 4], "au_pr": [3, 4], "thred_optim": [3, 4], "acc_best": [3, 4], "cm": [3, 4], "8792": 3, "8959": 3, "6800": 3, "0008": 3, "8117": 3, "1682": 3, "plot": [3, 4], "confusionmatrixdisplai": [3, 4], "disp": [3, 4], "display_label": [3, 4], "21": [3, 4], "distribut": [3, 4], "densiti": [3, 4], "p": [3, 4], "when": [3, 4], "hist": [3, 4], "bin": [3, 4], "alpha": [3, 4], "color": [3, 4], "green": [3, 4], "red": [3, 4], "legend": [3, 4], "28": 4, "exempl": 4, "biosnap": 4, "full_data": 4, "unseen_drug": 4, "unseen_protein": 4, "bindingdb": 4, "These": 4, "last": 4, "also": 4, "moltran": 4, "ex": 4, "githubusercont": 4, "kexinhuang12345": 4, "master": 4, "davi": 4, "dict_ind2fasta_al": 4, "u_smal": 4, "npy": 4, "lambda_smal": 4, "kroneck": 4, "k_p": 4, "With": 4, "constraint": 4, "u_": 4, "1200": 4, "lambda_": 4, "look": 4, "dict_fasta2ind_al": 4, "from_numpi": 4, "dp": 4, "y_all": 4, "indei": 4, "lt": 4, "ipython": 4, "02af9936bc10": 4, "gt": 4, "userwarn": 4, "copi": 4, "construct": 4, "recommend": 4, "sourcetensor": 4, "clone": 4, "detach": 4, "requires_grad_": 4, "rather": 4, "01": 4, "8838": 4, "i_val": 4, "j_val": 4, "y_val": 4, "n_val": 4, "7556": 4, "7649": 4, "5000": 4, "3497": 4, "6925": 4, "3917": 4, "hyperparamet": 4, "set": 4, "criterion": 4, "logspac": 4, "num": 4, "acc": 4, "aupr_max": 4, "y_pred_val": 4, "proba_pred_v": 4, "append": 4, "30": 4, "6659": 4, "8968": 4, "09": 4, "7499": 4, "08": 4, "1045": 4, "07": 4, "0310": 4, "06": 4, "0544": 4, "05": 4, "3243": 4, "0001": 4, "3547": 4, "001": 4, "4322": 4, "9367": 4, "6088": 4, "6306": 4, "6039": 4, "100": 4, "5971": 4, "8511095652601627": 4, "xscale": 4, "log": 4, "1627": 4, "23": 4, "8625": 4, "8726": 4, "7828": 4, "1004": 4, "8002": 4, "1670": 4, "24": 4}, "objects": {"": [[1, 0, 0, "-", "komet"]], "komet": [[1, 1, 1, "", "Morgan_FP"], [1, 1, 1, "", "Nystrom_X"], [1, 1, 1, "", "Nystrom_X_cn"], [1, 1, 1, "", "SVM_bfgs"], [1, 1, 1, "", "add_indfasta"], [1, 1, 1, "", "add_indsmiles"], [1, 1, 1, "", "compute_proba"], [1, 1, 1, "", "compute_proba_Platt_Scalling"], [1, 1, 1, "", "load_datas"], [1, 1, 1, "", "load_df"], [1, 1, 1, "", "results"]]}, "objtypes": {"0": "py:module", "1": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"]}, "titleterms": {"komet": [0, 1, 2, 3, 4], "kroneck": [0, 3], "optim": [0, 3], "method": [0, 3], "dti": [0, 3], "predict": [0, 3], "overview": 0, "citat": 0, "depend": 0, "instal": 0, "function": 0, "data": [0, 3], "load": [0, 3], "preprocess": 0, "molecular": 0, "featur": [0, 3, 4], "comput": 0, "model": 0, "train": [0, 3, 4], "evalu": 0, "exampl": 0, "usag": 0, "contribut": 0, "licens": 0, "indic": 0, "tabl": 0, "modul": 1, "1": [3, 4], "download": [3, 4], "from": [3, 4], "github": [3, 4], "repo": [3, 4], "util": [3, 4], "val": [3, 4], "test": [3, 4], "2": [3, 4], "calcul": [3, 4], "molecul": [3, 4], "us": [3, 4], "subsampl": [3, 4], "kernel": [3, 4], "approxim": [3, 4], "via": [3, 4], "nystrom": [3, 4], "3": [3, 4], "protein": [3, 4], "interact": [3, 4], "index": [3, 4], "choosen": [3, 4], "lambda": [3, 4], "uniprot": 4, "lakernel": 4, "svd": 4, "local": 4, "align": 4, "precalcul": 4, "20605": 4, "human": 4, "OF": 4, "4": 4, "algorithm": 4, "choic": 4, "search": 4, "best": 4, "choos": 4, "aupr": 4, "valid": 4, "dataset": 4, "lambda_max": 4}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.viewcode": 1, "nbsphinx": 4, "sphinx": 57}, "alltitles": {"Komet - Kronecker Optimized Method for DTI Prediction": [[0, "komet-kronecker-optimized-method-for-dti-prediction"]], "Overview": [[0, "overview"]], "Citation": [[0, "citation"]], "Dependencies": [[0, "dependencies"]], "Installation": [[0, "installation"]], "Functionalities": [[0, "functionalities"]], "Data Loading and Preprocessing": [[0, "data-loading-and-preprocessing"]], "Molecular Features Computation": [[0, "molecular-features-computation"]], "Model Training and Prediction": [[0, "model-training-and-prediction"]], "Evaluation": [[0, "evaluation"]], "Example Usage": [[0, "example-usage"]], "Contributing": [[0, "contributing"]], "License": [[0, "license"]], "Indices and tables": [[0, "indices-and-tables"]], "komet module": [[1, "module-komet"]], "komet": [[2, "komet"]], "komet : Kronecker Optimized METhod for DTI prediction": [[3, "komet-:-Kronecker-Optimized-METhod-for-DTI-prediction"]], "1. Download the data from a GitHub repo.": [[3, "1.-Download-the-data-from-a-GitHub-repo."]], "Download utils": [[3, "Download-utils"], [4, "Download-utils"]], "Download train/val/test": [[3, "Download-train/val/test"], [4, "Download-train/val/test"]], "2. Calculation of molecule features using a subsample of train molecules (molecule kernel approximated via Nystrom approximation)": [[3, "2.-Calculation-of-molecule-features-using-a-subsample-of-train-molecules-(molecule-kernel-approximated-via-Nystrom-approximation)"], [4, "2.-Calculation-of-molecule-features-using-a-subsample-of-train-molecules-(molecule-kernel-approximated-via-Nystrom-approximation)"]], "3. Calculation of protein features": [[3, "3.-Calculation-of-protein-features"]], "Load interactions index for train and test": [[3, "Load-interactions-index-for-train-and-test"]], "Training/Testing with a choosen lambda": [[3, "Training/Testing-with-a-choosen-lambda"]], "Komet with Uniprot LAkernel": [[4, "Komet-with-Uniprot-LAkernel"]], "1. Download from a GitHub repo.": [[4, "1.-Download-from-a-GitHub-repo."]], "3. Approximated protein features, using SVD of the Local Alignment kernel precalculated on 20605 human proteins": [[4, "3.-Approximated-protein-features,-using-SVD-of-the-Local-Alignment-kernel-precalculated-on-20605-human-proteins"]], "INDEX OF INTERACTIONS": [[4, "INDEX-OF-INTERACTIONS"]], "4. Komet algorithm": [[4, "4.-Komet-algorithm"]], "training with a choosen lambda": [[4, "training-with-a-choosen-lambda"]], "Choice of \\lambda: Search for the best lambda by choosing the best AUPR on the validation dataset": [[4, "Choice-of-\\lambda:-Search-for-the-best-lambda-by-choosing-the-best-AUPR-on-the-validation-dataset"]], "Training/testing with lambda_max": [[4, "Training/testing-with-lambda_max"]]}, "indexentries": {"morgan_fp() (in module komet)": [[1, "komet.Morgan_FP"]], "nystrom_x() (in module komet)": [[1, "komet.Nystrom_X"]], "nystrom_x_cn() (in module komet)": [[1, "komet.Nystrom_X_cn"]], "svm_bfgs() (in module komet)": [[1, "komet.SVM_bfgs"]], "add_indfasta() (in module komet)": [[1, "komet.add_indfasta"]], "add_indsmiles() (in module komet)": [[1, "komet.add_indsmiles"]], "compute_proba() (in module komet)": [[1, "komet.compute_proba"]], "compute_proba_platt_scalling() (in module komet)": [[1, "komet.compute_proba_Platt_Scalling"]], "komet": [[1, "module-komet"]], "load_datas() (in module komet)": [[1, "komet.load_datas"]], "load_df() (in module komet)": [[1, "komet.load_df"]], "module": [[1, "module-komet"]], "results() (in module komet)": [[1, "komet.results"]]}})