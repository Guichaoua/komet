Search.setIndex({"docnames": ["index", "komet", "modules", "vignettes/komet_v2"], "filenames": ["index.rst", "komet.rst", "modules.rst", "vignettes/komet_v2.ipynb"], "titles": ["Komet - Kronecker Optimized Method for DTI Prediction", "komet module", "komet", "Test of komet"], "terms": {"thi": 0, "librari": 0, "i": [0, 1, 3], "design": 0, "biologi": 0, "cheminformat": 0, "focus": 0, "analysi": [0, 3], "interact": [0, 1], "It": 0, "provid": 0, "tool": 0, "process": [0, 1], "protein": [0, 1], "fingerprint": [0, 1], "estim": [0, 1], "probabl": [0, 1, 3], "perform": [0, 1], "suit": 0, "particularli": 0, "us": [0, 1, 3], "research": 0, "develop": 0, "work": 0, "drug": 0, "discoveri": 0, "dock": 0, "simul": 0, "If": [0, 1, 3], "you": 0, "pleas": 0, "sure": 0, "cite": 0, "articl": 0, "yourlastname2024molecular": 0, "titl": [0, 3], "A": [0, 1], "analyz": 0, "author": 0, "yourlastnam": 0, "yourfirstnam": 0, "coauthorlastnam": 0, "coauthorfirstnam": 0, "journal": 0, "volum": 0, "xx": 0, "number": [0, 3], "page": 0, "year": 0, "2024": 0, "publish": 0, "publishernam": 0, "doi": 0, "10": [0, 3], "1234": 0, "jcbci": 0, "56789": 0, "url": 0, "http": [0, 3], "www": 0, "com": [0, 3], "abstract": 0, "introduc": 0, "comprehens": 0, "python": 0, "toolkit": 0, "cover": 0, "from": [0, 1], "aim": 0, "facilit": 0, "we": [0, 3], "detail": 0, "implement": 0, "kei": [0, 3], "morgan": [0, 1], "nystrom": [0, 1], "approxim": [0, 1, 3], "kernel": [0, 1], "svm": [0, 1], "base": 0, "l": [0, 1, 3], "bfg": [0, 1, 3], "alongsid": 0, "case": [0, 3], "studi": 0, "demonstr": 0, "its": 0, "applic": 0, "identifi": 0, "potenti": 0, "candid": 0, "The": [0, 1], "requir": 0, "follow": 0, "packag": [0, 3], "panda": [0, 3], "numpi": [0, 3], "rdkit": [0, 1, 3], "torch": [0, 1, 3], "scikit": 0, "learn": 0, "zipp": 0, "pickl": [0, 3], "To": [0, 3], "run": 0, "pip": [0, 3], "pypi": 0, "load_df": [0, 1, 2, 3], "name": [0, 1], "datafram": [0, 1, 3], "csv": [0, 1, 3], "file": [0, 1, 3], "clean": [0, 1, 3], "up": [0, 1], "smile": [0, 1, 3], "string": [0, 1], "cannot": [0, 1], "read": [0, 1], "add_indsmil": [0, 1, 2], "df": [0, 1], "add": [0, 1, 3], "each": [0, 1, 3], "uniqu": [0, 1, 3], "add_indfasta": [0, 1, 2], "an": [0, 1], "index": [0, 1], "column": [0, 1], "fasta": [0, 1, 3], "sequenc": [0, 1, 3], "morgan_fp": [0, 1, 2, 3], "list_smil": [0, 1, 3], "list": [0, 1, 3], "nystrom_x": [0, 1, 2], "smiles_list": [0, 1], "": [0, 1, 3], "morganfp": [0, 1, 3], "v": [0, 1], "rm": [0, 1], "mu": [0, 1], "epsi": [0, 1], "svm_bfg": [0, 1, 2, 3], "x_cn": [0, 1, 3], "y_cn": [0, 1, 3], "y": [0, 1, 3], "j": [0, 1, 3], "lamb": [0, 1, 3], "algorithm": [0, 1], "compute_proba_platt_scal": [0, 1, 2, 3], "w_bfg": [0, 1, 3], "platt": [0, 1, 3], "scale": [0, 1, 3], "compute_proba": [0, 1, 2, 3], "b_bfg": [0, 1, 3], "t": [0, 1, 3], "weight": [0, 1, 3], "paramet": [0, 1, 3], "result": [0, 1, 2, 3], "y_pred": [0, 1, 3], "proba_pr": [0, 1, 3], "return": [0, 1, 3], "variou": [0, 1], "metric": [0, 1, 3], "import": [0, 3], "pd": [0, 1, 3], "your": 0, "dataset": [0, 1], "molecule_data": 0, "welcom": 0, "have": 0, "suggest": 0, "improv": 0, "bug": 0, "fix": 0, "open": [0, 3], "issu": 0, "pull": 0, "request": 0, "mit": 0, "modul": [0, 2, 3], "search": 0, "sourc": 1, "comput": [1, 3], "which": 1, "tensor": [1, 3], "contain": [1, 3], "input": 1, "type": [1, 3], "featur": 1, "molecular": 1, "indic": 1, "subset": 1, "sampl": 1, "precomput": [1, 3], "eigenvector": 1, "matrix": [1, 3], "rank": 1, "eigenvalu": 1, "small": 1, "regular": 1, "term": 1, "ad": 1, "numer": 1, "stabil": 1, "train": 1, "model": [1, 3], "optim": [1, 3], "minim": 1, "loss": 1, "function": [1, 3], "compound": 1, "target": [1, 3], "label": 1, "molecul": 1, "bia": 1, "tupl": 1, "updat": 1, "indfasta": [1, 3], "arrai": [1, 3], "np": [1, 3], "ndarrai": 1, "offset": 1, "margin": 1, "valu": [1, 3], "predict": 1, "load_data": [1, 2, 3], "load": [1, 3], "data": [1, 3], "includ": 1, "pair": 1, "along": 1, "str": [1, 3], "extens": 1, "zip": [1, 3], "archiv": 1, "extract": 1, "first": 1, "can": 1, "accuraci": [1, 3], "auc": [1, 3], "averag": 1, "precis": 1, "threshold": [1, 3], "classif": 1, "best": [1, 3], "confus": [1, 3], "fals": [1, 3], "posit": [1, 3], "rate": [1, 3], "true": [1, 3], "befor": 1, "appli": [1, 3], "after": 1, "float": [1, 3], "calcul": 3, "local": 3, "align": 3, "precalcul": 3, "20605": 3, "human": 3, "chosen": 3, "5": 3, "load_ext": 3, "autoreload": 3, "matplotlib": 3, "pyplot": 3, "plt": 3, "sklearn": 3, "average_precision_scor": 3, "roc_curv": 3, "confusion_matrix": 3, "precision_scor": 3, "recall_scor": 3, "devic": 3, "cuda": 3, "0": 3, "is_avail": 3, "els": 3, "cpu": 3, "device_cpu": 3, "print": 3, "mytyp": 3, "float16": 3, "save": 3, "memori": 3, "onli": 3, "gpu": 3, "float32": 3, "6": 3, "sy": 3, "path": 3, "append": 3, "ajout": 3, "le": 3, "r\u00e9pertoir": 3, "parent": 3, "au": 3, "chemin": 3, "de": 3, "recherch": 3, "7": 3, "pour": 3, "connaitr": 3, "dan": 3, "quel": 3, "repertoir": 3, "et": 3, "o": 3, "getcwd": 3, "39": 3, "user": 3, "gguichaoua": 3, "dropbox": 3, "gwenn": 3, "chemogenomiqu": 3, "ipynb": 3, "8": 3, "path_data_set": 3, "biosnap": 3, "full_data": 3, "unseen_protein": 3, "unseen_drug": 3, "bindingdb": 3, "lcidb": 3, "double_orphan": 3, "9": 3, "data_dir": 3, "dataset_dir": 3, "full": 3, "ha": 3, "all": 3, "concat": 3, "shape": 3, "236530": 3, "21844": 3, "45005": 3, "303379": 3, "instal": 3, "drop_dupl": 3, "flatten": 3, "nm": 3, "len": 3, "mol": 3, "indsmil": 3, "dict_ind2smil": 3, "rang": 3, "dict_smiles2ind": 3, "x": 3, "143255": 3, "13": 3, "kernel_first": 3, "step": 3, "fp": 3, "mm": 3, "3000": 3, "medium": 3, "dm": 3, "1000": 3, "dim": 3, "In": 3, "ar": 3, "less": 3, "than": 3, "min": 3, "final": 3, "dimens": 3, "kroneck": 3, "nodmal": 3, "nystrom_x_cn": 3, "size": 3, "14": 3, "dtype": 3, "x_c": 3, "mean": 3, "axi": 3, "norm": 3, "none": 3, "var": 3, "folder": 3, "zg": 3, "y03kdtc553xg5q1ct59rj44c0000gn": 3, "ipykernel_83647": 3, "1192971215": 3, "py": 3, "userwarn": 3, "copi": 3, "construct": 3, "recommend": 3, "sourcetensor": 3, "clone": 3, "detach": 3, "requires_grad_": 3, "rather": 3, "16": 3, "mol2alt_sent": 3, "mol2sent": 3, "molsent": 3, "dfvec": 3, "sentences2vec": 3, "gensim": 3, "word2vec": 3, "def": 3, "sentenc": 3, "unseen": 3, "gener": 3, "vector": 3, "simpli": 3, "sum": 3, "individu": 3, "word": 3, "keyword": 3, "those": 3, "skip": 3, "stat": 3, "stackexchang": 3, "question": 3, "163005": 3, "how": 3, "set": 3, "dictionari": 3, "text": 3, "neural": 3, "network": 3, "163032": 3, "wv": 3, "key_to_index": 3, "vec": 3, "unseen_vec": 3, "get_vector": 3, "cluster": 3, "conplex_dev": 3, "model_300dim": 3, "pkl": 3, "chem": 3, "m": 3, "molfromsmil": 3, "radiu": 3, "wide_vector": 3, "unk": 3, "feat": 3, "from_numpi": 3, "squeez": 3, "stack": 3, "1019744889": 3, "53": 3, "17": 3, "same": 3, "order": 3, "ind_fasta": 3, "where": 3, "2069": 3, "18": 3, "dict_ind2fasta_al": 3, "rb": 3, "dict_fasta2ind_al": 3, "ind": 3, "item": 3, "dict_ind2fasta_all_k_prot": 3, "f": 3, "kp_all": 3, "filenotfounderror": 3, "traceback": 3, "most": 3, "recent": 3, "call": 3, "last": 3, "cell": 3, "line": 3, "4": 3, "34": 3, "gt": 3, "opt": 3, "anaconda3": 3, "env": 3, "conplex": 3, "dti": 3, "lib": 3, "python3": 3, "site": 3, "ipython": 3, "core": 3, "interactiveshel": 3, "284": 3, "_modified_open": 3, "arg": 3, "kwarg": 3, "277": 3, "278": 3, "rais": 3, "valueerror": 3, "279": 3, "won": 3, "let": 3, "fd": 3, "default": 3, "280": 3, "like": 3, "crash": 3, "know": 3, "what": 3, "do": 3, "281": 3, "builtin": 3, "282": 3, "io_open": 3, "errno": 3, "No": 3, "directori": 3, "i_fasta": 3, "dict": 3, "kp": 3, "prot": 3, "just": 3, "rp": 3, "500": 3, "u": 3, "vt": 3, "diag": 3, "sqrt": 3, "nomramlis": 3, "y_c": 3, "src": 3, "protbertfeatur": 3, "target_featur": 3, "save_dir": 3, "save_emb": 3, "per_tok": 3, "preload": 3, "esmfeatur": 3, "prott5xluniref50featur": 3, "prosefeatur": 3, "30": 3, "n": 3, "31": 3, "1e": 3, "w": 3, "time": 3, "208": 3, "1987": 3, "second": 3, "i_test": 3, "j_test": 3, "y_test": 3, "n_test": 3, "y_pred_test": 3, "proba_pred_test": 3, "acc1": 3, "au_roc": 3, "au_pr": 3, "acc_best": 3, "35": 3, "i_val": 3, "j_val": 3, "y_val": 3, "n_val": 3, "36": 3, "5442226529121399": 3, "roc": 3, "7673417850891948": 3, "aupr": 3, "8052481767994024": 3, "072426796": 3, "712964653968811": 3, "8267": 3, "2655": 3, "3615": 3, "7307": 3, "24308734663980955": 3, "20": 3, "hyperparamet": 3, "criterion": 3, "logspac": 3, "11": 3, "num": 3, "acc": 3, "aupr_max": 3, "86": 3, "0356": 3, "8419150710105896": 3, "9083730903647832": 3, "6750785577914972": 3, "3419631": 3, "8288165926933289": 3, "4700": 3, "1015": 3, "122": 3, "805": 3, "17760279965004375": 3, "84": 3, "5113": 3, "8289671540260315": 3, "9043180147249664": 3, "65638850488429": 3, "40460488": 3, "8282144069671631": 3, "4710": 3, "1005": 3, "136": 3, "791": 3, "17585301837270342": 3, "09": 3, "83": 3, "7543": 3, "8322794437408447": 3, "9055372932752338": 3, "6691062563722949": 3, "39101088": 3, "8252032399177551": 3, "4684": 3, "1031": 3, "130": 3, "797": 3, "18040244969378827": 3, "08": 3, "87": 3, "3111": 3, "8367961645126343": 3, "9050319896636436": 3, "6538557067669664": 3, "27169403": 3, "8095453381538391": 3, "4571": 3, "1144": 3, "121": 3, "806": 3, "20017497812773402": 3, "07": 3, "0610": 3, "8413128852844238": 3, "898182549187824": 3, "5906168814317218": 3, "560705": 3, "8477867841720581": 3, "4830": 3, "885": 3, "126": 3, "801": 3, "15485564304461943": 3, "06": 3, "82": 3, "8357": 3, "8587774634361267": 3, "8908866974152503": 3, "5921083491238845": 3, "17162679": 3, "8232460021972656": 3, "4648": 3, "1067": 3, "107": 3, "820": 3, "18670166229221347": 3, "05": 3, "93": 3, "1512": 3, "8632941842079163": 3, "9046732561881761": 3, "6470255779108688": 3, "2109009": 3, "8416139483451843": 3, "4770": 3, "945": 3, "16535433070866143": 3, "0001": 3, "92": 3, "8947": 3, "8652514219284058": 3, "9128823163555472": 3, "6760962771623839": 3, "31450766": 3, "8479373455047607": 3, "4829": 3, "886": 3, "124": 3, "803": 3, "15503062117235344": 3, "001": 3, "118": 3, "9441": 3, "8762421011924744": 3, "8714791314516106": 3, "5704874609561449": 3, "31661108": 3, "7764227390289307": 3, "4359": 3, "1356": 3, "129": 3, "798": 3, "23727034120734908": 3, "01": 3, "26": 3, "5274": 3, "8705209493637085": 3, "8602230546424416": 3, "5380128298017853": 3, "36445245": 3, "7907257080078125": 3, "4477": 3, "1238": 3, "152": 3, "775": 3, "21662292213473316": 3, "22": 3, "6550": 3, "13956639170646667": 3, "8602231490211513": 3, "5380165933689808": 3, "36445835": 3, "29": 3, "3713": 3, "36445826": 3, "0537": 3, "5380165933689807": 3, "3644583": 3, "100": 3, "4565": 3, "8604335784912109": 3, "8598630942437482": 3, "5349158498741108": 3, "5000001": 3, "7917795777320862": 3, "4488": 3, "1227": 3, "156": 3, "771": 3, "2146981627296588": 3, "plot": 3, "21": 3, "xscale": 3, "log": 3, "show": 3, "49": 3, "7617": 3, "50": 3, "6011": 3, "51": 3, "9530860185623169": 3, "8008677532083972": 3, "4512337685744232": 3, "67166746": 3, "8702378869056702": 3, "5012": 3, "696": 3, "219": 3, "12193412754029433": 3}, "objects": {"": [[1, 0, 0, "-", "komet"]], "komet": [[1, 1, 1, "", "Morgan_FP"], [1, 1, 1, "", "Nystrom_X"], [1, 1, 1, "", "SVM_bfgs"], [1, 1, 1, "", "add_indfasta"], [1, 1, 1, "", "add_indsmiles"], [1, 1, 1, "", "compute_proba"], [1, 1, 1, "", "compute_proba_Platt_Scalling"], [1, 1, 1, "", "load_datas"], [1, 1, 1, "", "load_df"], [1, 1, 1, "", "results"]]}, "objtypes": {"0": "py:module", "1": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"]}, "titleterms": {"komet": [0, 1, 2, 3], "kroneck": 0, "optim": 0, "method": 0, "dti": 0, "predict": 0, "overview": 0, "citat": 0, "depend": 0, "instal": 0, "function": 0, "data": 0, "load": 0, "preprocess": 0, "molecular": 0, "featur": [0, 3], "comput": 0, "model": 0, "train": [0, 3], "evalu": 0, "exampl": 0, "usag": 0, "contribut": 0, "licens": 0, "indic": 0, "tabl": 0, "modul": 1, "test": 3, "1": 3, "download": 3, "dataset": 3, "val": 3, "you": 3, "can": 3, "choos": 3, "differ": 3, "databas": 3, "2": 3, "molecul": 3, "nystrom": 3, "approx": 3, "tanimoto": 3, "kernel": 3, "b": 3, "morgan": 3, "fingerprint": 3, "ecfp4": 3, "c": 3, "mol2vec": 3, "3": 3, "protein": 3, "svd": 3, "lakernel": 3, "protbert": 3, "other": 3, "from": 3, "complex": 3, "index": 3, "OF": 3, "interact": 3, "svm": 3, "valid": 3, "choic": 3, "lambda": 3, "lambda_max": 3}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.viewcode": 1, "nbsphinx": 4, "sphinx": 57}, "alltitles": {"Komet - Kronecker Optimized Method for DTI Prediction": [[0, "komet-kronecker-optimized-method-for-dti-prediction"]], "Overview": [[0, "overview"]], "Citation": [[0, "citation"]], "Dependencies": [[0, "dependencies"]], "Installation": [[0, "installation"]], "Functionalities": [[0, "functionalities"]], "Data Loading and Preprocessing": [[0, "data-loading-and-preprocessing"]], "Molecular Features Computation": [[0, "molecular-features-computation"]], "Model Training and Prediction": [[0, "model-training-and-prediction"]], "Evaluation": [[0, "evaluation"]], "Example Usage": [[0, "example-usage"]], "Contributing": [[0, "contributing"]], "License": [[0, "license"]], "Indices and tables": [[0, "indices-and-tables"]], "komet module": [[1, "module-komet"]], "komet": [[2, "komet"]], "Test of komet": [[3, "Test-of-komet"]], "1. Downloading the dataset (train/val/test) : you can choose different databases": [[3, "1.-Downloading-the-dataset-(train/val/test)-:-you-can-choose-different-databases"]], "2. Molecule features": [[3, "2.-Molecule-features"]], "a. Nystrom approx Tanimoto kernel": [[3, "a.-Nystrom-approx-Tanimoto-kernel"]], "b. Morgan fingerprint (ECFP4)": [[3, "b.-Morgan-fingerprint-(ECFP4)"]], "c. Mol2Vec": [[3, "c.-Mol2Vec"]], "3. Protein features": [[3, "3.-Protein-features"]], "a. SVD of LAkernel": [[3, "a.-SVD-of-LAkernel"]], "B. Protbert": [[3, "B.-Protbert"]], "Other from Complex": [[3, "Other-from-Complex"]], "INDEX OF INTERACTIONS": [[3, "INDEX-OF-INTERACTIONS"]], "SVM": [[3, "SVM"]], "validation (choice of \\lambda)": [[3, "validation-(choice-of-\\lambda)"]], "test with lambda_max": [[3, "test-with-lambda_max"]]}, "indexentries": {"morgan_fp() (in module komet)": [[1, "komet.Morgan_FP"]], "nystrom_x() (in module komet)": [[1, "komet.Nystrom_X"]], "svm_bfgs() (in module komet)": [[1, "komet.SVM_bfgs"]], "add_indfasta() (in module komet)": [[1, "komet.add_indfasta"]], "add_indsmiles() (in module komet)": [[1, "komet.add_indsmiles"]], "compute_proba() (in module komet)": [[1, "komet.compute_proba"]], "compute_proba_platt_scalling() (in module komet)": [[1, "komet.compute_proba_Platt_Scalling"]], "komet": [[1, "module-komet"]], "load_datas() (in module komet)": [[1, "komet.load_datas"]], "load_df() (in module komet)": [[1, "komet.load_df"]], "module": [[1, "module-komet"]], "results() (in module komet)": [[1, "komet.results"]]}})